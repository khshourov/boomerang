# Task 5.7: Migrate CLI to SDK

This task involves refactoring the `boomerang-cli` module to use the `boomerang-client-java` library for all communication with the Boomerang server, removing duplicated logic.

## Status
- **Status:** Completed
- **Priority:** Medium
- **Owner:** Developer

## Objectives
1.  [x] Update `boomerang-cli/build.gradle.kts` to depend on `boomerang-client-java`.
2.  [x] Refactor `io.boomerang.cli.BoomTool` and its commands to use `io.boomerang.client.BoomerangClient` from the SDK.
3.  [x] Remove `io.boomerang.cli.client.BoomerangClient` and `io.boomerang.cli.client.BoomerangClientHandler`.
4.  [x] Update all CLI tests to reflect the changes.
5.  [x] Ensure the CLI still functions correctly with the SDK.

## Requirements
- The CLI should maintain its current functionality and user interface.
- Communication logic should be entirely handled by the `boomerang-client-java` SDK.
- The `boomerang-cli` module should no longer have direct Netty dependencies for server communication (though it might still have them if `picocli` or other tools use them, but the manual Netty client should be gone).

## Sub-tasks
1.  [x] **Dependency Update:** Add `boomerang-client-java` as a dependency in `boomerang-cli/build.gradle.kts`.
2.  [x] **SDK Integration in Commands:**
    - [x] Update `AdminClientRegisterCommand.java`
    - [x] Update `AdminClientDeregisterCommand.java`
    - [x] Update `TaskRegisterCommand.java`
    - [x] Update `TaskCancelCommand.java`
    - [x] Update `TaskListCommand.java`
    - [x] Update `TaskGetCommand.java`
3.  [x] **BoomTool Refactoring:** Update `BoomTool.java` to manage the SDK client lifecycle.
4.  [x] **Cleanup:** Remove the `io.boomerang.cli.client` package and its contents.
5.  [x] **Test Update:** Update `BoomToolTest.java`, `BoomToolAuthTest.java`, and all command tests.
6. [x] **Validation:** Run integration tests to ensure the CLI works with a live/mock server.
7. [x] **Smart Client Integration:** Switched from `DefaultBoomerangClient` to `SmartBoomerangClient` to support automatic session refresh and re-login.
8. [x] **SDK Coverage:** Added missing unit tests for `registerClient` and `deregisterClient` in the SDK module.
9. [x] **Code Quality:** Fixed formatting violations in `boomerang-client-java`.

## Verification Plan
- [x] **Automated Tests:** Run `./gradlew :boomerang-cli:test`.
- [x] **Manual Verification:** Build the CLI and run commands against a local `BoomerangServer`.
- [x] **Mutation Testing:** Run `./gradlew :boomerang-cli:pitest` to ensure no regression in test quality.
- [x] **SDK Tests:** Run `./gradlew :boomerang-client-java:test`.

